"use strict";(globalThis.webpackChunkmomento_docs=globalThis.webpackChunkmomento_docs||[]).push([[416],{22707:(e,t,a)=>{a.d(t,{A:()=>N});var n=a(96540),i=a(34164),s=a(79872),r=a(44319),o=a(56347),l=a(94280),d=a(73024),c=a(58417),h=a(44031);function m(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:t,children:a}=e;return(0,n.useMemo)((()=>{const e=t??function(e){return m(e).map((({props:{value:e,label:t,attributes:a,default:n}})=>({value:e,label:t,attributes:a,default:n})))}(a);return function(e){const t=(0,c.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,a])}function p({value:e,tabValues:t}){return t.some((t=>t.value===e))}function g({queryString:e=!1,groupId:t}){const a=(0,o.W6)(),i=function({queryString:e=!1,groupId:t}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,d.aZ)(i),(0,n.useCallback)((e=>{if(!i)return;const t=new URLSearchParams(a.location.search);t.set(i,e),a.replace({...a.location,search:t.toString()})}),[i,a])]}function f(e){const{defaultValue:t,queryString:a=!1,groupId:i}=e,s=u(e),[r,o]=(0,n.useState)((()=>function({defaultValue:e,tabValues:t}){if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const a=t.find((e=>e.default))??t[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:s}))),[d,c]=g({queryString:a,groupId:i}),[m,f]=function({groupId:e}){const t=function(e){return e?`docusaurus.tab.${e}`:null}(e),[a,i]=(0,h.Dv)(t);return[a,(0,n.useCallback)((e=>{t&&i.set(e)}),[t,i])]}({groupId:i}),v=(()=>{const e=d??m;return p({value:e,tabValues:s})?e:null})();(0,l.A)((()=>{v&&o(v)}),[v]);return{selectedValue:r,selectValue:(0,n.useCallback)((e=>{if(!p({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),c(e),f(e)}),[c,f,s]),tabValues:s}}var v=a(46916);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=a(74848);function y({className:e,block:t,selectedValue:a,selectValue:n,tabValues:s}){const o=[],{blockElementScrollPositionUntilNextRender:l}=(0,r.a_)(),d=e=>{const t=e.currentTarget,i=o.indexOf(t),r=s[i].value;r!==a&&(l(t),n(r))},c=e=>{let t=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const a=o.indexOf(e.currentTarget)+1;t=o[a]??o[0];break}case"ArrowLeft":{const a=o.indexOf(e.currentTarget)-1;t=o[a]??o[o.length-1];break}}t?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":t},e),children:s.map((({value:e,label:t,attributes:n})=>(0,x.jsx)("li",{role:"tab",tabIndex:a===e?0:-1,"aria-selected":a===e,ref:e=>{o.push(e)},onKeyDown:c,onClick:d,...n,className:(0,i.A)("tabs__item",b.tabItem,n?.className,{"tabs__item--active":a===e}),children:t??e},e)))})}function E({lazy:e,children:t,selectedValue:a}){const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const e=s.find((e=>e.props.value===a));return e?(0,n.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:s.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==a})))})}function j(e){const t=f(e);return(0,x.jsxs)("div",{className:(0,i.A)(s.G.tabs.container,"tabs-container",b.tabList),children:[(0,x.jsx)(y,{...t,...e}),(0,x.jsx)(E,{...t,...e})]})}function N(e){const t=(0,v.A)();return(0,x.jsx)(j,{...e,children:m(e.children)},String(t))}},28453:(e,t,a)=>{a.d(t,{R:()=>r,x:()=>o});var n=a(96540);const i={},s=n.createContext(i);function r(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(s.Provider,{value:t},e.children)}},53632:(e,t,a)=>{a.d(t,{A:()=>r});a(96540);var n=a(34164);const i={tabItem:"tabItem_Ymn6"};var s=a(74848);function r({children:e,hidden:t,className:a}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,n.A)(i.tabItem,a),hidden:t,children:e})}},78302:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>l,metadata:()=>n,toc:()=>h});const n=JSON.parse('{"id":"media-storage/streaming/decoding-video","title":"Decoding video streams","description":"Discover how to decode media in your video player for live streaming or video on demand (VOD)","source":"@site/docs/media-storage/streaming/decoding-video.md","sourceDirName":"media-storage/streaming","slug":"/media-storage/streaming/decoding-video","permalink":"/media-storage/streaming/decoding-video","draft":false,"unlisted":false,"editUrl":"https://github.com/momentohq/public-dev-docs/tree/main/docs/media-storage/streaming/decoding-video.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"Decoding video streams","title":"Decoding video streams","description":"Discover how to decode media in your video player for live streaming or video on demand (VOD)","pagination_next":null,"hide_title":true,"keywords":["momento","media storage","origin","decoding","streaming","live","elemental","serverless"]},"sidebar":"mediastorageSidebar","previous":{"title":"Overview","permalink":"/media-storage/streaming/overview"}}');var i=a(74848),s=a(28453),r=a(22707),o=a(53632);const l={sidebar_position:2,sidebar_label:"Decoding video streams",title:"Decoding video streams",description:"Discover how to decode media in your video player for live streaming or video on demand (VOD)",pagination_next:null,hide_title:!0,keywords:["momento","media storage","origin","decoding","streaming","live","elemental","serverless"]},d="Decoding video streams",c={},h=[{value:"How video players work",id:"how-video-players-work",level:2},{value:"Manifest files and segments stored in Momento Media Storage",id:"manifest-files-and-segments-stored-in-momento-media-storage",level:3},{value:"Using a token query parameter",id:"using-a-token-query-parameter",level:4},{value:"Using a CDN with header forwarding",id:"using-a-cdn-with-header-forwarding",level:3},{value:"Adaptive bitrate streaming (ABR)",id:"adaptive-bitrate-streaming-abr",level:3},{value:"Master and media playlists",id:"master-and-media-playlists",level:4},{value:"Using a single manifest",id:"using-a-single-manifest",level:4}];function m(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"decoding-video-streams",children:"Decoding video streams"})}),"\n",(0,i.jsxs)(t.p,{children:["Decoding video streams allows video players to stream content, whether it's ",(0,i.jsx)(t.a,{href:"/media-storage/streaming/live-streaming/how-it-works",children:"live streaming"})," or ",(0,i.jsx)(t.a,{href:"/media-storage/streaming/video-on-demand/media-storage",children:"video on demand (VOD)"}),". The process involves fetching ",(0,i.jsx)(t.a,{href:"/media-storage/core-concepts/segments",children:"segments"})," from a content delivery network (CDN), decoding them into viewable content, and delivering the video to the viewer's screen with minimal delay. Two widely used protocols dominate video streaming: ",(0,i.jsx)(t.a,{href:"/media-storage/performance/adaptive-bitrates/hls",children:"HLS (HTTP Live Streaming)"})," and ",(0,i.jsx)(t.a,{href:"/media-storage/performance/adaptive-bitrates/dash",children:"DASH (Dynamic Adaptive Streaming over HTTP)"}),". These protocols rely on ",(0,i.jsx)(t.em,{children:"manifest files"})," to point the player at the location of segments at the ",(0,i.jsx)(t.a,{href:"/media-storage/core-concepts/abr-ladder",children:"desired bitrate and resolution"}),"."]}),"\n",(0,i.jsx)(t.h2,{id:"how-video-players-work",children:"How video players work"}),"\n",(0,i.jsxs)(t.p,{children:["As mentioned ealier, the two main protocols in video streaming are HLS and DASH. Both protocols enable support for ",(0,i.jsx)(t.a,{href:"/media-storage/performance/adaptive-bitrates/how-it-works",children:"adaptive bitrate streaming (ABR)"}),", allowing the player to switch between different resolutions and bitrates dynamically to optimize playback quality based on the viewer's network conditions. This is done through the use of ",(0,i.jsx)(t.strong,{children:"manifest files"}),"."]}),"\n",(0,i.jsx)(t.h3,{id:"manifest-files-and-segments-stored-in-momento-media-storage",children:"Manifest files and segments stored in Momento Media Storage"}),"\n",(0,i.jsxs)(t.p,{children:["Manifest files list available video segments for a stream, along with their corresponding bitrates and resolutions. These manifest files direct the video player to the specific segments and other manifests stored in ",(0,i.jsx)(t.strong,{children:"Momento Media Storage"}),"."]}),"\n",(0,i.jsxs)(t.p,{children:["Stored segments and bitrate/resolution specific manifest files are identified by ",(0,i.jsx)(t.strong,{children:"key names"}),". The key names map either directly to the url where the segment lives or to a relative path based on the base URL of the manifest. Files stored in Momento Media Storage are accessible via HTTP based on the namespace and name of the key."]}),"\n",(0,i.jsx)(t.p,{children:"Since all data in the Momento platform is stored securely by default, authorization is required for access. Given the nature of how video players work, manifest files are typically structured in one of two ways:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Directly at Momento with a ",(0,i.jsx)(t.code,{children:"token"})," query parameter"]}),"\n",(0,i.jsxs)(t.li,{children:["Pointed at a CDN that forwards an ",(0,i.jsx)(t.code,{children:"Authorization"})," header"]}),"\n"]}),"\n",(0,i.jsx)(t.h4,{id:"using-a-token-query-parameter",children:"Using a token query parameter"}),"\n",(0,i.jsxs)(t.p,{children:["Live streams are short-lived by nature. As content is recorded, it is streamed to end users in the moment. After it plays, it's over and the segments aren't accessible unless the provider decides to make it available on demand. This use case is perfect for a ",(0,i.jsx)(t.a,{href:"/cache/develop/authentication/tokens",children:"Momento session token"}),", which is created with a finite duration and limited scope permission set."]}),"\n",(0,i.jsxs)(t.p,{children:["Tokens used for live streaming should be generated with ",(0,i.jsx)(t.code,{children:"readonly"})," access scoped to either a specific namespace or ",(0,i.jsx)(t.a,{href:"/cache/develop/authentication/permissions#item-level-restriction",children:"key prefix"})," to operate with least-privilege permissions. The path to segments or manifest files should match one of the examples below."]}),"\n",(0,i.jsxs)(r.A,{children:[(0,i.jsx)(o.A,{value:"hls-absolute",label:"HLS - Absolute",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"#EXTINF:2.000,\nhttps://<MOMENTO_REGION_BASE_URL>/cache/<NAMESPACE>/<SEGMENT_1_NAME>?token=<MOMENTO_TOKEN>\n#EXTINF:2.000,\nhttps://<MOMENTO_REGION_BASE_URL>/cache/<NAMESPACE>/<SEGMENT_2_NAME>?token=<MOMENTO_TOKEN>\n"})})}),(0,i.jsx)(o.A,{value:"hls-relative",label:"HLS - Relative",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"#EXTINF:2.000,\n/cache/<NAMESPACE>/<SEGMENT_1_NAME>?token=<MOMENTO_TOKEN>\n#EXTINF:2.000,\n/cache/<NAMESPACE>/<SEGMENT_2_NAME>?token=<MOMENTO_TOKEN>\n"})})}),(0,i.jsx)(o.A,{value:"dash-absolute",label:"DASH - Absolute",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:'<SegmentURL media="https://<MOMENTO_REGION_BASE_URL>/cache/<NAMESPACE>/<SEGMENT_1_NAME>?token=<MOMENTO_TOKEN>" />\n<SegmentURL media="https://<MOMENTO_REGION_BASE_URL>/cache/<NAMESPACE>/<SEGMENT_2_NAME>?token=<MOMENTO_TOKEN>" />\n'})})}),(0,i.jsx)(o.A,{value:"dash-relative",label:"DASH - Relative",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:'<SegmentURL media="/cache/<NAMESPACE>/<SEGMENT_1_NAME>?token=<MOMENTO_TOKEN>" />\n<SegmentURL media="/cache/<NAMESPACE>/<SEGMENT_2_NAME>?token=<MOMENTO_TOKEN>" />\n'})})})]}),"\n",(0,i.jsx)(t.p,{children:"In the examples above, the placeholders resolve to the following values:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"MOMENTO_REGION_BASE_URL"})," - The ",(0,i.jsx)(t.a,{href:"/platform/regions",children:"endpoint"})," for the region being used as the origin"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"NAMESPACE"})," - Name of the namespace/cache in the origin region"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"SEGMENT_#_NAME"})," - Key of the segment stored in Momento. Typically ends with ",(0,i.jsx)(t.code,{children:".ts"})," for HLS and ",(0,i.jsx)(t.code,{children:".m4s"})," for DASH"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"MOMENTO_TOKEN"})," - Short-lived token granting read access to the specific segment in the namespace"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"using-a-cdn-with-header-forwarding",children:"Using a CDN with header forwarding"}),"\n",(0,i.jsxs)(t.p,{children:["In video on demand (VOD) workflows, requests for access to segments could come at any point in time, so using a short-lived token is not a possible solution. Instead, using a CDN like Amazon CloudFront or Cloudflare to forward your request with added headers is a viable alternative using a long-lived ",(0,i.jsx)(t.a,{href:"/cache/develop/authentication/api-keys",children:"Momento API key"}),". This solution allows video players to make calls do your CDN without knowledge of a token or API key and have it automatically added for them on the server side."]}),"\n",(0,i.jsx)(t.admonition,{title:"Note",type:"warning",children:(0,i.jsx)(t.p,{children:"The solution above should include some sort of authentication mechanism or firewall support to prevent malicious attacks. It is potentially unsafe to expose data publicly without some form of auth"})}),"\n",(0,i.jsx)(t.p,{children:"The calls to your CDN serve as a proxy to the Momento platform. It will be calling Momento directly on behalf of your users. Below are examples of manifest files using header forwarding."}),"\n",(0,i.jsxs)(r.A,{children:[(0,i.jsx)(o.A,{value:"hls-proxy-absolute",label:"HLS - Absolute",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"#EXTINF:2.000,\nhttps://<YOUR_BASE_URL>/<SEGMENT_1_NAME>\n#EXTINF:2.000,\nhttps://<YOUR_BASE_URL>/<SEGMENT_2_NAME>\n"})})}),(0,i.jsx)(o.A,{value:"hls-proxy-relative",label:"HLS - Relative",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"#EXTINF:2.000,\n<SEGMENT_1_NAME>\n#EXTINF:2.000,\n<SEGMENT_2_NAME>\n"})})}),(0,i.jsx)(o.A,{value:"dash-proxy-absolute",label:"DASH - Absolute",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:'<SegmentURL media="https://<YOUR_BASE_URL>/<SEGMENT_1_NAME>" />\n<SegmentURL media="https://<YOUR_BASE_URL>/<SEGMENT_2_NAME>" />\n'})})}),(0,i.jsx)(o.A,{value:"dash-proxy-relative",label:"DASH - Relative",children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-xml",children:'<SegmentURL media="<SEGMENT_1_NAME>" />\n<SegmentURL media="<SEGMENT_2_NAME>" />\n'})})})]}),"\n",(0,i.jsx)(t.p,{children:"In the examples above, the placeholders resolve to the following values:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"YOUR_BASE_URL"})," - The base url of your CDN"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"SEGMENT_#_NAME"})," - Key of the segment stored in Momento. Typically ends with ",(0,i.jsx)(t.code,{children:".ts"})," for HLS and ",(0,i.jsx)(t.code,{children:".m4s"})," for DASH"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["The tradeoff between the two options is where the simplicity lies. With ",(0,i.jsx)(t.strong,{children:"short-lived tokens"}),", the simplicity lies in your architecture, you're making direct calls to the Momento HTTP service after having generated a short-lived session token. With the ",(0,i.jsx)(t.strong,{children:"CDN approach"}),", the simplicity lies in your manifest files, but you have a more complicated server-side implementation to manage."]}),"\n",(0,i.jsx)(t.h3,{id:"adaptive-bitrate-streaming-abr",children:"Adaptive bitrate streaming (ABR)"}),"\n",(0,i.jsxs)(t.p,{children:["Adaptive bitrate streaming (ABR) allows the video player to adjust the quality of the stream dynamically, providing the best possible experience based on the viewer's network conditions. The streaming process typically involves multiple manifests: a ",(0,i.jsx)(t.strong,{children:"master manifest"})," (also called a ",(0,i.jsx)(t.em,{children:"master playlist"}),") that lists different quality levels and ",(0,i.jsx)(t.strong,{children:"media playlists"})," for each bitrate and resolution. The player selects the appropriate playlist based on the available bandwidth and can switch between quality levels in real-time to maintain smooth playback."]}),"\n",(0,i.jsx)(t.h4,{id:"master-and-media-playlists",children:"Master and media playlists"}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.strong,{children:"master manifest"})," is the top-level file that points to other ",(0,i.jsx)(t.strong,{children:"media playlists"}),". Each media playlist contains the list of segments for a ",(0,i.jsx)(t.a,{href:"/media-storage/core-concepts/abr-ladder",children:"specific combination of bitrate and resolution"}),". This structure allows the player to choose the most suitable stream, dynamically switching between quality levels as network conditions change."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-plaintext",children:"#EXTM3U\n#EXT-X-STREAM-INF:BANDWIDTH=5000000,RESOLUTION=1920x1080\n1080p.m3u8\n#EXT-X-STREAM-INF:BANDWIDTH=3000000,RESOLUTION=1280x720\n720p.m3u8\n#EXT-X-STREAM-INF:BANDWIDTH=1500000,RESOLUTION=854x480\n480p.m3u8\n"})}),"\n",(0,i.jsx)(t.p,{children:"In this example:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["The master manifest lists three different quality levels: ",(0,i.jsx)(t.em,{children:"1080p at 5mbps"}),", ",(0,i.jsx)(t.em,{children:"720p at 3mbps"}),", and ",(0,i.jsx)(t.em,{children:"480p at 1.5mbps"}),"."]}),"\n",(0,i.jsx)(t.li,{children:"Each entry points to a media playlist in Momento Media Storage for that specific quality level using relative paths"}),"\n"]}),"\n",(0,i.jsx)(t.h4,{id:"using-a-single-manifest",children:"Using a single manifest"}),"\n",(0,i.jsx)(t.p,{children:"While it's common for ABR to rely on this master-media playlist structure, it\u2019s not strictly required. In some simpler streaming setups, a single manifest can point directly to the video segments for one bitrate and resolution. However, without multiple playlists, the player won\u2019t be able to adapt dynamically to network conditions, limiting the playback experience to a fixed quality level."}),"\n",(0,i.jsx)(t.p,{children:"If you're supporting adaptive streaming, a master manifest with media playlists is required to provide the ability to switch between different quality levels seamlessly."})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}}}]);
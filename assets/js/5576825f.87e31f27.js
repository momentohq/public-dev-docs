(self.webpackChunkmomento_docs=self.webpackChunkmomento_docs||[]).push([[6853],{5195:(e,t,n)=>{"use strict";n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>u});var o=n(4848),s=n(8453),r=n(8254),i=n(7206);const a={sidebar_position:30,title:"Leverage Momento Topics, webhooks, and tokens in your event-driven architectures",sidebar_label:"Identifying unique resources",description:"Learn best practices around using Momento Topics, webhooks, and tokens to process unique resources in your event-driven architectures.",keywords:["topics","webhooks","eda","momento","event-driven architecture"]},c="Leverage Momento Topics, webhooks, and tokens in your event-driven architectures",l={id:"topics/patterns/token_id_webhook",title:"Leverage Momento Topics, webhooks, and tokens in your event-driven architectures",description:"Learn best practices around using Momento Topics, webhooks, and tokens to process unique resources in your event-driven architectures.",source:"@site/docs/topics/patterns/token_id_webhook.md",sourceDirName:"topics/patterns",slug:"/topics/patterns/token_id_webhook",permalink:"/topics/patterns/token_id_webhook",draft:!1,unlisted:!1,editUrl:"https://github.com/momentohq/public-dev-docs/tree/main/docs/topics/patterns/token_id_webhook.md",tags:[],version:"current",sidebarPosition:30,frontMatter:{sidebar_position:30,title:"Leverage Momento Topics, webhooks, and tokens in your event-driven architectures",sidebar_label:"Identifying unique resources",description:"Learn best practices around using Momento Topics, webhooks, and tokens to process unique resources in your event-driven architectures.",keywords:["topics","webhooks","eda","momento","event-driven architecture"]},sidebar:"topicsSidebar",previous:{title:"Running background tasks",permalink:"/topics/patterns/running-background-tasks"},next:{title:"Develop",permalink:"/topics/develop/"}},d={},u=[{value:"Getting Started",id:"getting-started",level:2},{value:"See More",id:"see-more",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"leverage-momento-topics-webhooks-and-tokens-in-your-event-driven-architectures",children:"Leverage Momento Topics, webhooks, and tokens in your event-driven architectures"})}),"\n",(0,o.jsxs)(t.p,{children:["With ",(0,o.jsx)(t.a,{href:"../",children:"Momento Topics"}),", you can subscribe to messages on a topic and publish messages to a different topic. ",(0,o.jsx)(t.a,{href:"../webhooks/overview",children:"Webhooks"})," serve as HTTP callbacks triggered in response to messages published to these topics, acting as stateless consumers. ",(0,o.jsx)(t.a,{href:"../../cache/develop/authentication/tokens",children:"Tokens"})," are designed to provide short-lived session tokens for users and services interacting with a system. By embedding unique identifiers (",(0,o.jsx)(t.code,{children:"token_id"}),") in each token, they ensure secure and traceable access to resources."]}),"\n",(0,o.jsxs)(t.p,{children:["The key here is that you can use Topics to facilitate real-time communication between users by granting them short-lived tokens. These tokens can be embedded with user information (",(0,o.jsx)(t.code,{children:"token_id"}),"), which, when messages are published, can be leveraged to access shared resources like Momento caches via webhook callbacks. For instance, you can personalize user experiences by accessing their information stored in a Momento cache by identifying the user through the ",(0,o.jsx)(t.code,{children:"token_id"}),". Embedding information provides two significant advantages:"]}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"It enhances security and prevents a user from spoofing their identity."}),"\n",(0,o.jsx)(t.li,{children:"It reduces data transfer costs as the user information is embedded with the token itself."}),"\n"]}),"\n",(0,o.jsx)(t.p,{children:(0,o.jsx)(t.img,{alt:"Architecture",src:n(4999).A+"",width:"547",height:"520"})}),"\n",(0,o.jsx)(t.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,o.jsxs)(t.ol,{children:["\n",(0,o.jsx)(t.li,{children:(0,o.jsx)(t.a,{href:"https://console.gomomento.com/caches/create",children:"Create a cache in the Momento console"})}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.a,{href:"/topics/webhooks/creating-a-webhook",children:"Create a webhook"})," for the cache. Assign the webhook destination to a public facing endpoint. This endpoint must accept POST requests and be able to receive inbound calls from Momento. More detail about the structure of this event is ",(0,o.jsx)(t.a,{href:"../webhooks/overview#example-event",children:"described here"}),"."]}),"\n",(0,o.jsx)(t.li,{children:"Create your infrastructure. For example, below is sample code that creates a lambda function URL for our webhook endpoint. It also stores\nyour Momento auth token in AWS secrets manager."}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"<SdkExampleCodeBlock language={'javascript'} file={'examples/nodejs/aws/lambda-examples/webhooks/infrastructure/lib/momento-webhook-stack.ts'} />\n"})}),"\n",(0,o.jsxs)(t.ol,{start:"4",children:["\n",(0,o.jsxs)(t.li,{children:["Add code to the webhook to process incoming messages. Below is sample code for the webhook lambda handler that extracts a user's ",(0,o.jsx)(t.code,{children:"token_id"})," from the webhook payload, and access resources stored in Momento cache. It also verifies that the webhook caller is indeed Momento through the signing secret."]}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"<SdkExampleCodeBlock language={'javascript'} file={'examples/nodejs/aws/lambda-examples/webhooks/lambda/webhook-handler/handler.ts'} />\n"})}),"\n",(0,o.jsxs)(t.ol,{start:"5",children:["\n",(0,o.jsx)(t.li,{children:"Finally, below has sample code for generating the token and publishing user messages on a topic. In a real-world,\nthese would ideally live in separate micro-services."}),"\n"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"<SdkExampleCodeBlock language={'javascript'} file={'examples/nodejs/aws/lambda-examples/webhooks/lambda/service-topics/handler.ts'} />\n"})}),"\n",(0,o.jsx)(t.h2,{id:"see-more",children:"See More"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"By integrating Momento topics, webhooks, and tokens, you can create secure and stateless asynchronous systems. This convention can be applied to a variety of use-cases such as multi-language chat app, online polling, and event-driven systems."}),"\n"]}),"\n","\n",(0,o.jsxs)(r.p,{children:[(0,o.jsx)(i.V,{title:"Multi-language chat app",link:"https://github.com/momentohq/moderated-chat/",description:"Explore the source code of our live-translation chat app using webhooks."}),(0,o.jsx)(i.V,{title:"Use webhooks with API Gateway + Lambda",link:"https://www.gomomento.com/blog/how-to-use-webhooks-and-momento-topics-to-build-a-multi-language-chat-app",description:"Learn how to integrate Momento webhooks with Amazon API Gateway and Lambda functions"})]})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},4788:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__monkey_patch__=function(e,t){"types"===e?Object.assign(h,t):b[e]=t},t.attrs=a,t.legacyMerge=t.keyframes=t.include=t.firstThatWorks=t.defineVars=t.default=t.createTheme=t.create=void 0,t.props=i,t.types=void 0;var o=n(3176);const s=e=>new Error(`'stylex.${e}' should never be called at runtime. It should be compiled away by '@stylexjs/babel-plugin'`),r=e=>s(`types.${e}`);function i(){const e=this;for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];if(b.props)return b.props.call(e,n);const[r,i]=(0,o.styleq)(n),a={};return null!=r&&""!==r&&(a.className=r),null!=i&&Object.keys(i).length>0&&(a.style=i),a}function a(){const{className:e,style:t}=i(...arguments),n={};return null!=e&&""!==e&&(n.class=e),null!=t&&Object.keys(t).length>0&&(n.style=Object.keys(t).map((e=>`${e}:${t[e]};`)).join("")),n}const c=t.create=function(e){if(null!=b.create){return(0,b.create)(e)}throw s("create")},l=t.defineVars=function(e){if(b.defineVars)return b.defineVars(e);throw s("defineVars")},d=t.createTheme=(e,t)=>{if(b.createTheme)return b.createTheme(e,t);throw s("createTheme")},u=t.include=e=>{if(b.include)return b.include(e);throw s("include")},h=t.types={angle:e=>{throw r("angle")},color:e=>{throw r("color")},url:e=>{throw r("url")},image:e=>{throw r("image")},integer:e=>{throw r("integer")},lengthPercentage:e=>{throw r("lengthPercentage")},length:e=>{throw r("length")},percentage:e=>{throw r("percentage")},number:e=>{throw r("number")},resolution:e=>{throw r("resolution")},time:e=>{throw r("time")},transformFunction:e=>{throw r("transformFunction")},transformList:e=>{throw r("transformList")}},p=e=>{if(b.keyframes)return b.keyframes(e);throw s("keyframes")};t.keyframes=p;const m=function(){if(b.firstThatWorks)return b.firstThatWorks(...arguments);throw s("firstThatWorks")};function f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[s]=(0,o.styleq)(t);return s}t.firstThatWorks=m,f.props=i,f.attrs=a,f.create=c,f.defineVars=l,f.createTheme=d,f.include=u,f.keyframes=p,f.firstThatWorks=m,f.types=h;const b={};t.legacyMerge=f;t.default=f},8254:(e,t,n)=>{"use strict";var o=n(6305).default;t.p=void 0;o(n(4788));var s=n(4848);t.p=e=>{let{variant:t,children:n}=e;return(0,s.jsx)("div",{...{0:{className:"xrvj5dj xoybqp3 x1p9eum2"},1:{className:"xrvj5dj xoybqp3 x1wlfl8j"}}[!("dense"!==t)|0],children:n})}},7206:(e,t,n)=>{"use strict";var o=n(6305).default;t.V=void 0;o(n(4788));var s=n(4848);t.V=e=>{let{title:t,description:n,link:o,icon:r,alignText:i="start",alignItems:a="start"}=e;return(0,s.jsxs)("a",{href:o,target:"_blank",...{0:{className:"x78zum5 xh8yej3 x1in32aq x1tamke2 x1q0g3np x7a106z xou54vl xqlwffn x12oqio5 x15ny4rc xokoxfd x1hl2dhg x1heor9g"},1:{className:"x78zum5 xh8yej3 x1in32aq x1tamke2 x1q0g3np xou54vl xqlwffn x12oqio5 x15ny4rc xokoxfd x1hl2dhg x1heor9g x6s0dn4"}}[!("center"!==a)|0],children:[r&&(0,s.jsx)("img",{src:r,height:"32px",width:"32px"}),(0,s.jsxs)("div",{...{0:{className:"x1iyjqo2 x1yc453h"},1:{className:"x1iyjqo2 x2b8uid"}}[!("center"!==i)|0],children:[(0,s.jsx)("h3",{className:"x1q12cbh",children:t}),(0,s.jsx)("p",{className:"xif65rj xo1l8bm x1du4iog",children:n})]})]})}},3176:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styleq=void 0;var n=new WeakMap;function o(e){var t,o,s;return null!=e&&(t=!0===e.disableCache,o=!0===e.disableMix,s=e.transform),function(){for(var e=[],r="",i=null,a=t?null:n,c=new Array(arguments.length),l=0;l<arguments.length;l++)c[l]=arguments[l];for(;c.length>0;){var d=c.pop();if(null!=d&&!1!==d)if(Array.isArray(d))for(var u=0;u<d.length;u++)c.push(d[u]);else{var h=null!=s?s(d):d;if(h.$$css){var p="";if(null!=a&&a.has(h)){var m=a.get(h);null!=m&&(p=m[0],e.push.apply(e,m[1]),a=m[2])}else{var f=[];for(var b in h){var g=h[b];"$$css"!==b&&("string"==typeof g||null===g?e.includes(b)||(e.push(b),null!=a&&f.push(b),"string"==typeof g&&(p+=p?" "+g:g)):console.error("styleq: ".concat(b," typeof ").concat(String(g),' is not "string" or "null".')))}if(null!=a){var x=new WeakMap;a.set(h,[p,f,x]),a=x}}p&&(r=r?p+" "+r:p)}else if(o)null==i&&(i={}),i=Object.assign({},h,i);else{var k=null;for(var v in h){var y=h[v];void 0!==y&&(e.includes(v)||(null!=y&&(null==i&&(i={}),null==k&&(k={}),k[v]=y),e.push(v),a=null))}null!=k&&(i=Object.assign(k,i))}}}return[r,i]}}var s=o();t.styleq=s,s.factory=o},4999:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});const o=n.p+"assets/images/token-id-webhook-06b7252991e86f2953c2aba0f917efbf.png"},6305:(e,t,n)=>{var o=n(3738).default;function s(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}e.exports=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=o(e)&&"function"!=typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var c=i?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(r,a,c):r[a]=e[a]}return r.default=e,n&&n.set(e,r),r},e.exports.__esModule=!0,e.exports.default=e.exports},3738:e=>{function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},8453:(e,t,n)=>{"use strict";n.d(t,{R:()=>i,x:()=>a});var o=n(6540);const s={},r=o.createContext(s);function i(e){const t=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(r.Provider,{value:t},e.children)}}}]);
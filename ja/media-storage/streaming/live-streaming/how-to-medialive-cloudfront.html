<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-media-storage/streaming/live-streaming/how-to-medialive-cloudfront" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">How to configure a live origin with Momento | Momento Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.momentohq.com/ja/media-storage/streaming/live-streaming/how-to-medialive-cloudfront"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" property="og:locale:alternate" content="en_US"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="How to configure a live origin with Momento | Momento Docs"><meta data-rh="true" name="description" content="Using Momento Storage as a live HLS origin for AWS MediaLive and CloudFront."><meta data-rh="true" property="og:description" content="Using Momento Storage as a live HLS origin for AWS MediaLive and CloudFront."><meta data-rh="true" name="keywords" content="momento,media storage,origin,encoding,streaming,live,elemental,tutorial,how to,guide,medialive,CloudFront"><link data-rh="true" rel="icon" href="/ja/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.momentohq.com/ja/media-storage/streaming/live-streaming/how-to-medialive-cloudfront"><link data-rh="true" rel="alternate" href="https://docs.momentohq.com/media-storage/streaming/live-streaming/how-to-medialive-cloudfront" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://docs.momentohq.com/ja/media-storage/streaming/live-streaming/how-to-medialive-cloudfront" hreflang="ja"><link data-rh="true" rel="alternate" href="https://docs.momentohq.com/media-storage/streaming/live-streaming/how-to-medialive-cloudfront" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://3P10N8HW6D-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Momento Docs" href="/ja/opensearch.xml">

<link rel="stylesheet" href="/ja/stylex.css">
<!-- Google Tag Manager -->
    <script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-THBDHDQ",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>
    <!-- End Google Tag Manager --><link rel="stylesheet" href="/ja/assets/css/styles.2b7b47a5.css">
<script src="/ja/assets/js/runtime~main.32ec448d.js" defer="defer"></script>
<script src="/ja/assets/js/main.287f0eba.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="ナビゲーション" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ja/"><div class="navbar__logo"><img src="/ja/img/momento-docs-logo-forest.svg" alt="Momento Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ja/img/momento-docs-logo-white.svg" alt="Momento Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/ja/cache">Cache</a><a class="navbar__item navbar__link" href="/ja/topics">Topics</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/ja/platform">Platform</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>日本語</a><ul class="dropdown__menu"><li><a href="/media-storage/streaming/live-streaming/how-to-medialive-cloudfront" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-US">English</a></li><li><a href="/ja/media-storage/streaming/live-streaming/how-to-medialive-cloudfront" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">日本語</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="ダークモードを切り替える(現在はライトモード)" aria-label="ダークモードを切り替える(現在はライトモード)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="検索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">検索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="ドキュメントのサイドバー" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/media-storage/overview">Momento Media Storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/media-storage/use-cases">Common use cases</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/ja/media-storage/core-concepts/origin">Core Concepts</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/core-concepts/origin">Origin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/core-concepts/segments">Segments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/core-concepts/abr-ladder">ABR ladder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/core-concepts/zero-buffer-rate">Zero buffer rate (ZBR)</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/ja/media-storage/streaming/overview">Streaming</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/streaming/overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/streaming/decoding-video">Decoding video streams</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/ja/media-storage/streaming/capture/rtmp">Video capture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/ja/media-storage/streaming/live-streaming/how-it-works">Live streaming</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/streaming/live-streaming/how-it-works">How it works</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ja/media-storage/streaming/live-streaming/how-to-medialive-cloudfront">Quick start guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/streaming/live-streaming/glass-to-glass-latency">Glass-to-glass latency</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/ja/media-storage/streaming/video-on-demand/media-storage">Video on demand (VOD)</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Performance</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/performance/optimizing-delivery">Optimizing delivery</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/ja/media-storage/performance/adaptive-bitrates/how-it-works">Adaptive bitrates</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/ja/media-storage/concurrency/account-level">Concurrency</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/concurrency/account-level">Device management</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/concurrency/devices">Device management</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/ja/media-storage/entitlements/about">Entitlements</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/entitlements/about">About</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/entitlements/real-time-updates">Real-time updates</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/ja/media-storage/enhancements/heartbeats">Insights and Control</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/enhancements/heartbeats">Viewer metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/enhancements/viewer-metrics">Viewer metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/media-storage/enhancements/live-reactions">Live reactions</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/ja/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Streaming</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Live streaming</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Quick start guide</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>Creating a live video origin with Momento Media Storage, AWS MediaLive, and Amazon CloudFront</h1></header>
<p>Live video streaming requires a highly performant and scalable <a href="/ja/media-storage/core-concepts/origin">origin server</a> to handle the demands of a global audience. Traditional origin servers often struggle with latency, scalability, or complexity when integrated with modern cloud workflows. Momento Media Storage offers a simple, high-scale solution by providing a robust, low-latency, and cost-effective origin solution tailored for live video streaming.</p>
<p>In this tutorial, you will learn how to set up Momento Media Storage as the origin server for a live video stream encoded by <a href="https://aws.amazon.com/medialive/" target="_blank" rel="noopener noreferrer">AWS Elemental MediaLive</a> and delivered via <a href="https://aws.amazon.com/CloudFront/" target="_blank" rel="noopener noreferrer">Amazon CloudFront</a>. By the end of this guide, you&#x27;ll have a fully functional workflow capable of delivering live <a href="/ja/media-storage/performance/adaptive-bitrates/hls">HLS streams</a> optimized for performance and reliability.</p>
<p>Here&#x27;s what we&#x27;ll cover:</p>
<ol>
<li>Creating a storage namespace in Momento Media Storage to act as the origin server.</li>
<li>Configuring AWS Elemental MediaLive to encode and push live content to Momento.</li>
<li>Setting up Amazon CloudFront to serve content to viewers with low latency.</li>
<li>Testing and troubleshooting the setup to ensure smooth playback.</li>
</ol>
<p>In this tutorial, we will use the <a href="https://console.gomomento.com" target="_blank" rel="noopener noreferrer">Momento console</a>, but everything could be created and configured programmatically through <a href="/ja/platform/sdks">the Momento SDK</a>.</p>
<p><strong>Prefer to learn through video?</strong></p>
<p>Watch this quick walkthrough of the tutorial to see the steps in action. This video compliments the guide below and is perfect if you&#x27;re a visual learner or want a high-level overview or additional context before diving into the details.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/dwb8Qd7CDYw?si=ALK8BnC2Ugh5ty-S" title="YouTube video player" frameborder="0" allow="accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin"></iframe>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="preparation">Preparation<a href="#preparation" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h2>
<p>Before creating any resources, please determine the basic characteristics of the live video channel.</p>
<p><strong>Channel bitrates</strong>: The bitrate of a channel depends on the resolution, framerate, and encoding. The table below lists the example bitrates used in this guide.</p>
<p><strong>Segment duration</strong>: Segment duration should fall between 1 and 2.5 seconds to minimize glass-to-glass latency. This guide uses 2.5 seconds.</p>
<p><strong>TTL (Time-to-Live)</strong>: TTL determines how long stream data remains available for playback. This guide uses 3600 seconds (1 hour). Note that if your product includes features like DVR playback, you may need a much longer TTL measured in days.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>ヒント</div><div class="admonitionContent_BuS1"><p>Momento Media Storage supports a maximum object size of 10MB. To estimate segment size, divide the bitrate in Kbps by 8, multiply by the segment duration in seconds, and add 10% to account for headers. For example, a 2 second segment at 1000 Kbps is roughly <code>1000 / 8 * 2 * 1.1 = 275 KB</code>.</p></div></div>
<p>For the purposes of this tutorial, configure one live video channel for an <a href="/ja/media-storage/core-concepts/abr-ladder">adaptive bitrate ladder</a> with 3 encoding profiles and 2.5-second segments:</p>
<table><thead><tr><th style="text-align:center">resolution</th><th style="text-align:center">framerate</th><th style="text-align:center">bitrate</th><th style="text-align:center">segment size</th></tr></thead><tbody><tr><td style="text-align:center"><code>720p</code></td><td style="text-align:center"><code>30</code></td><td style="text-align:center"><code>2,500 kbps</code></td><td style="text-align:center"><code>850 KiB</code></td></tr><tr><td style="text-align:center"><code>480p</code></td><td style="text-align:center"><code>30</code></td><td style="text-align:center"><code>1,500 kbps</code></td><td style="text-align:center"><code>500 KiB</code></td></tr><tr><td style="text-align:center"><code>240p</code></td><td style="text-align:center"><code>30</code></td><td style="text-align:center"><code>750 kbps</code></td><td style="text-align:center"><code>250 KiB</code></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-create-a-storage-namespace-in-your-momento-account">1. Create a storage namespace in your Momento account<a href="#1-create-a-storage-namespace-in-your-momento-account" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h2>
<p>Momento Media Storage is currently restricted to private preview access by key design partners. To create a storage namespace, please ensure that you have successfully logged in to the <a href="https://console.gomomento.com/" target="_blank" rel="noopener noreferrer">Momento Console</a> once to initialize your account. Then, contact <code>support@momentohq.com</code> or your support representative with the following information to create a storage namespace:</p>
<ul>
<li><strong>account id</strong>: Locate your account id in the dropdown in the upper right corner of the <a href="https://console.gomomento.com/" target="_blank" rel="noopener noreferrer">console</a> (<code>a-xxxxxxxxxxxx</code>).</li>
<li><strong>namespace id</strong>: The desired id for the new storage namespace. This guide uses <code>live-origin</code>.</li>
<li><strong>AWS region</strong>: The AWS region for the new storage namespace. This guide uses <code>us-west-1</code>. Once AZ-alignment becomes available, you will also need to specify two AZs within the region.</li>
<li><strong>hot storage capacity</strong>: This determines how much stream data will be held in low-latency storage. Estimate required capacity by adding up the size of all segments and multiplying by the number of segments to keep in hot storage. For example, keeping 5 minutes of the example bitrate ladder in hot storage requires <code>(850+500+250)Kib * 300/2.5 ≈ 200 MiB</code>.</li>
</ul>
<p>While Momento Media Storage is in private preview, the Storage <em>namespace</em> will be appear as a <em>cache</em> in the console. This guide will use <em>namespace</em> interchangeably with <em>cache</em>. As Momento Media Storage approaches general availability, updates to the console will make namespace creation a self-service process.</p>
<p>Next, generate the API key that the encoder will use to securely write segment and manifest files to the <code>live-origin</code> namespace. In the <a href="https://console.gomomento.com/api-keys" target="_blank" rel="noopener noreferrer">API Key section</a> of Momento console, create a Fine-Grained Access Key that expires in 30 days with <em>readwrite</em> access to the <code>live-origin</code> namespace. Don&#x27;t forget to click on &quot;Add Permission&quot; to grant the permissions before generating the API key.</p>
<p><img decoding="async" loading="lazy" alt="Momento console showing readwrite permissions for the live-origin namespace" src="/ja/assets/images/console-api-key-2-a4a7f23149d0dfbb3526c1fd7694ef90.png" width="1593" height="936" class="img_ev3q"></p>
<p>API key information will no longer be available after you navigate away from this page, so download the API key as a JSON file. The guide will refer to this API key as <code>encoder_api_key</code>.</p>
<p>Video players read the content pushed by encoders to Momento Media Storage via a <strong>Content Delivery Network (CDN)</strong>. As a security best practices, create a second API key with <em>readonly</em> access to the <code>live-origin</code> namespace. Use the same <a href="https://console.gomomento.com/api-keys" target="_blank" rel="noopener noreferrer">API key page</a> as before to create this new API key. The guide will refer to this API key as <code>player_api_key</code>.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Checking in</div><div class="admonitionContent_BuS1"><p>At the end of this step, you should have created two API keys: one that grants <em>readwrite</em> access and one that <em>readonly</em> access to the <code>live-origin</code> namespace. Keep these handy to use in the upcoming steps.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-set-up-aws-medialive-for-live-video-encoding">2. Set up AWS MediaLive for live video encoding<a href="#2-set-up-aws-medialive-for-live-video-encoding" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h2>
<p>AWS Elemental MediaLive is a live video encoding service from AWS that processes and delivers live streams at scale. MediaLive converts live video into streaming formats like <a href="/ja/media-storage/performance/adaptive-bitrates/hls">HLS</a>. It is commonly used for live sports, major live events, and 24/7 channels.</p>
<p>MediaLive will act as the <strong>encoder</strong> in this live video workflow. The encoded video will be sent directly to Momento Media Storage, which functions as the origin server.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>ヒント</div><div class="admonitionContent_BuS1"><p>For best performance, make sure the MediaLive service and the <code>live-origin</code> namespace are in the same AWS region or as close as possible. If you are new to MediaLive, refer to the <a href="https://docs.aws.amazon.com/medialive/latest/ug/container-planning-workflow.html" target="_blank" rel="noopener noreferrer">AWS documentation</a> for detailed setup instructions.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="channel-settings">Channel settings<a href="#channel-settings" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h3>
<p>First navigate to the <a href="https://console.aws.amazon.com/medialive/home#/channels/new" target="_blank" rel="noopener noreferrer">create channel</a> page in AWS MediaLive. Give your channel a meaningful name, and if this is your first time using the service, follow the instructions to <em>Create role from template</em> to create an IAM role with the necessary permissions for encoding. After setup, select the <code>MediaLiveAccessRole</code> role.</p>
<p>We will not be using a channel template or changing any input specifications. However, we will be changing the <strong>Channel class</strong> to <code>SINGLE_PIPELINE</code>. Leave all other configuration fields alone, the default values are appropriate for our use case. Once configured, you should have something that resembles the screenshot below.</p>
<p><img decoding="async" loading="lazy" alt="MediaLive channel settings page fully configured" src="/ja/assets/images/medialive-channel-settings-b64f02e72b5ec37d26b680c3cf50413b.png" width="1269" height="1111" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="input-attachments">Input attachments<a href="#input-attachments" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h3>
<p>Next, we must configure an input for our channel. The input is the media that will be streamed on our channel while it is active. You can either click the <em>Add</em> button next to the <strong>Input attachments</strong> label, or <a href="https://console.aws.amazon.com/medialive/home#/inputs" target="_blank" rel="noopener noreferrer">navigate directly</a> to the input list.</p>
<p>If you already have an input you&#x27;d like to use, select it now. Otherwise, click on the <em>Create input</em> button to create a new one. For our example, we will be streaming a copy of <em>Big Buck Bunny</em> in MP4 format that is publicly available in an S3 bucket. So let&#x27;s give it an appropriate name, input type of <code>MP4</code>, and select an <strong>Input class</strong> of <code>SINGLE_INPUT</code>.</p>
<p>Put the publicly accessible url to the MP4 in the <strong>Input source A</strong> field, and leave all other fields alone. It should resemble the following:</p>
<p><img decoding="async" loading="lazy" alt="MediaLive completed input page" src="/ja/assets/images/medialive-input-settings-9769919d1c0b7a7c673ff19bf8ba5df2.png" width="1340" height="1138" class="img_ev3q"></p>
<p>Once configured, hit the <em>Create input</em> button, navigate back to the channel configuration page, and select the input we just created.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="output-groups">Output groups<a href="#output-groups" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h3>
<p>Now time for the important part: configuring the outputs we would like the input converted to. As mentioned at the beginning of this tutorial, we will be generating three variants at different resolutions: <em>720p</em>, <em>480p</em>, and <em>240p</em>. To do this, we configure an output group for our channel.</p>
<p>Click on the <em>Add</em> button next to <strong>Output groups</strong> on the channel configuration page, select <em>HLS</em> as the output group type, and hit the <em>Confirm</em> button.</p>
<p>The destination URL is going to be writing directly to the <a href="https://docs.momentohq.com/cache/develop/api-reference/http-api" target="_blank" rel="noopener noreferrer">Momento HTTP API</a> using the <code>encoder_api_key</code> we setup earlier. It should be in the following format:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://&lt;momento_rest_endpoint&gt;/cache/&lt;namespace_id&gt;/playlist.m3u8?ttl_seconds=&lt;ttl&gt;&amp;role=origin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The variable placeholders are:</p>
<ul>
<li><code>momento_rest_endpoint</code> - Momento HTTP API region-specific endpoint (<a href="/ja/platform/regions">see list</a>)</li>
<li><code>namespace_id</code> - ID of the namespace receiving uploaded segments</li>
<li><code>ttl</code> - number of seconds to retain the playlist and segments before deletion</li>
</ul>
<p><em>NOTE - notice the <code>role=origin</code> query parameter at the end. This is required for MediaLive to publish segments!</em></p>
<p>As an example, your destination URL should look something like this:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://api.cache.cell-4-us-west-2-1.prod.a.momentohq.com/cache/live-origin/playlist.m3u8?ttl_seconds=3600&amp;role=origin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Next, expand the <em>Credentials</em> section. Set <em>Username</em> to <code>momento</code>. Select <strong>Create parameter</strong> under <em>Password</em> and follow the instructions to create a new parameter named <code>/medialive/momento_api_key</code> that contains the previously-created encoder API key.</p>
<p>Under <em>CDN Settings</em>, select <strong>HLS Akamai</strong>. We use <strong>HLS Akamai</strong> so that MediaLive will properly transmit credentials with each request. There&#x27;s a small quirk with the service when using <em>HLS basic put</em> that omits the credentials.</p>
<p><img decoding="async" loading="lazy" alt="AWS MediaLive console with channel configuration filled out" src="/ja/assets/images/medialive-hls-group-06db498b5dadcfa35c3e4e21c6447c2d.png" width="1338" height="1436" class="img_ev3q"></p>
<p>In the <strong>Manifest and Segments</strong> section, configure the following fields:</p>
<ul>
<li><strong>Output Selection</strong> - MANIFESTS_AND_SEGMENTS</li>
<li><strong>Mode</strong> - LIVE</li>
<li><strong>TS File Mode</strong> - SEGMENTED_FILES</li>
<li><strong>Segment Length</strong> - 2</li>
</ul>
<p>The remaining settings should match the configuration below:</p>
<p><img decoding="async" loading="lazy" alt="AWS MediaLive console with output configuration complete" src="/ja/assets/images/medialive-segments-865e610dfd66c11fbaa5dae87166cf45.png" width="1449" height="830" class="img_ev3q"></p>
<p>Finally, we configure how AWS Elemental MediaLive updates the variant playlists: the variant playlists are derived from the master manifest by appending a <em>Name modifier</em> at the end of the master playlist chosen name. For each variant playlist/output, add a descriptive modifier that tells us at a glance which playlist we are looking at. For example, each of the variant playlists in the example bitrate ladder will have <code>_480p30</code>, <code>_240p30</code>, and <code>_720p30</code> as the <em>Name Modifier</em>. Since we named the master manifest <code>playlist.m3u8</code>, the resulting variant manifests will be named respectively <code>playlist_480p30.m3u8</code>, <code>playlist_240p30.m3u8</code>, and <code>playlist_720p30.m3u8</code>. This naming convention will need to be specified in the CloudFront settings below.</p>
<p><img decoding="async" loading="lazy" alt="AWS MediaLive console with the name modifier configured for all outputs" src="/ja/assets/images/medialive-output-8013ead6ef592f79ec11c8d9a97edf5d.png" width="1436" height="819" class="img_ev3q"></p>
<p>Once everything is configured, hit the <em>Create channel</em> button to create the encoder!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-optimize-content-delivery-with-amazon-cloudfront">3. Optimize content delivery with Amazon CloudFront<a href="#3-optimize-content-delivery-with-amazon-cloudfront" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h2>
<p>Amazon CloudFront is a Content Delivery Network (CDN) that ensures the live video streams are delivered quickly and reliably to viewers worldwide. In this step, we&#x27;ll configure CloudFront to work with Momento Media Storage - optimizing latency, managing costs, and securing access.</p>
<p>CloudFront will serve two key purposes in this workflow:</p>
<ol>
<li>Reduce latency and costs by caching video segments across its Points of Presence (PoPs).</li>
<li>Secure access to the Momento origin by adding the appropriate authorization tokens to requests.</li>
</ol>
<p><a href="/ja/media-storage/core-concepts/segments">Media segments</a> are assets that change infrequently. They represent 1-5 seconds of video, audio, or metadata that will not change once it&#x27;s been generated by the encoder. These media assets are usually best cached by a CDN service like Amazon CloudFront across multiple PoPs located close to the end viewers for both <a href="/ja/media-storage/streaming/live-streaming/how-it-works">live</a> and <a href="/ja/media-storage/streaming/video-on-demand/media-storage">VOD</a> video workflows.</p>
<p>While VOD workflows have HLS manifests that never change once they are created, HLS manifests in live video workflows are constantly recreated by the encoders to present the latest media segments, at the &quot;live point&quot;. As a result, <em>live HLS manifests should not be cached by a CDN for longer than the size of a media segment</em>. So we will <strong>not cache the manifests</strong> and instead hand them over the Momento origin, which is designed to manage frequently changing objects.</p>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>ヒント</div><div class="admonitionContent_BuS1"><p>You can optimize retrieval of manifest files by specifying a short TTL in the appropriate CloudFront behavior.</p></div></div>
<p>In the <a href="https://console.aws.amazon.com/cloudfront" target="_blank" rel="noopener noreferrer">Amazon CloudFront console</a>, create a CloudFront distribution that enables these rules through custom CloudFront behaviors.</p>
<p><img decoding="async" loading="lazy" alt="CloudFront console with the create distribution fields completed" src="/ja/assets/images/cloudfront-origin-a1e9cbd1c710e1b9f52d8249986c6444.png" width="1433" height="885" class="img_ev3q"></p>
<p>The <em>Origin domain</em> of the CloudFront distribution must be set as the <code>momento_rest_endpoint</code> url we used to configure the MediaLive channel, with the <em>Origin path</em> as <code>/cache/&lt;namespace_id&gt;</code>. Note the <em>Origin path</em> field <strong>is required for this workflow</strong>.</p>
<p>Since CloudFront is accessed by video players, which don&#x27;t go through auth flows to obtain API keys or session tokens, we must set up the default policy to add an <em>Authorization</em> header with <code>player_api_key</code> for incoming requests. This enables CloudFront to automatically forward an API key to Momento, granting read-only access to the generated segments.</p>
<p>You do not need to enable the <em>Origin Shield</em> functionality of CloudFront, Momento takes care of it natively.</p>
<p>For the <strong>Web Application Firewall (WAF)</strong> settings, select <em>Do not enable security protections</em> for the demo.</p>
<p>Now we need to define the CloudFront behaviors for three types of objects read from the Momento origin server:</p>
<ol>
<li>The default behavior</li>
<li>The behavior for media segments</li>
<li>The behavior for variant playlists</li>
</ol>
<p><img decoding="async" loading="lazy" alt="CloudFront console listing the caching behaviors and their policies" src="/ja/assets/images/cloudfront-behaviors-92f08c82ed020eb64f587494e7f9954b.png" width="1444" height="527" class="img_ev3q"></p>
<p><strong>Default behavior</strong>: This &quot;behavior&quot; is for items that are not part of the video origin workflow. We assume these objects will be changed frequently, so we won&#x27;t cache them in CloudFront, using the a &quot;CachingDisabled&quot; policy. Configure the policy as outlined below.</p>
<p><img decoding="async" loading="lazy" alt="CloudFront behavior for the default behavior" src="/ja/assets/images/cloudfront-default-566d7cf82846c4605a1f7cbede42a0d0.png" width="1446" height="895" class="img_ev3q"></p>
<p><strong>Media segments behavior</strong>: These files won&#x27;t change after the encoder has sent them to the origin, so they are good candidates for being cached by CloudFront and its &quot;CachingOptimized&quot; policy. From the AWS MediaLive configuration, the segments that contain audio/video will always have the file extension <code>.ts</code> :</p>
<p><img decoding="async" loading="lazy" alt="CloudFront behavior for caching segments" src="/ja/assets/images/cloudfront-segments-76df56e726fd2007b4fb5a7e747d1b81.png" width="1450" height="864" class="img_ev3q"></p>
<p><strong>Variant playlists behavior</strong>: These <code>playlist_*.m3u8</code> files are refreshed every time a new media segment is available from AWS Elemental MediaLive. When MediaLive recreates the playlists, it automatically appends the <code>encoder_api_key</code> token query parameter in its URI. Since the default rules apply a different, conflicting value (<code>player_api_key</code>) in <em>Authorization</em> header when requesting these segments, we need to define a behavior where the <em>Authorization</em> header is dropped for these requests. To accomplish this, set the <em>Origin request policy</em> to None.</p>
<p><img decoding="async" loading="lazy" alt="CloudFront behavior for variant playlists" src="/ja/assets/images/cloudfront-playlist-051452112d56ec21ffd125f52f727c8e.png" width="1450" height="840" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-starting-the-stream">4. Starting the stream<a href="#4-starting-the-stream" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h2>
<p>Now that we have our CDN configured allowing video players to access the playlists and segments, let&#x27;s see if it works! Navigate back to the <a href="https://console.aws.amazon.com/medialive/home#/channels" target="_blank" rel="noopener noreferrer">channel we created</a> and hit the <strong>Start</strong> button. After a few moments, your channel will be broadcasting the video!</p>
<p><img decoding="async" loading="lazy" alt="MediaLive channel in a playing status" src="/ja/assets/images/medialive-channel-playing-6b5d71f8d44c1220b1287783a640cb56.png" width="1343" height="627" class="img_ev3q"></p>
<p>That&#x27;s it, the stream is active and will be creating segments and uploading them to our <code>live-origin</code> cache. Now let&#x27;s see it in action.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-watching-the-stream">5. Watching the stream<a href="#5-watching-the-stream" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h2>
<p>If you already have a compatible media player like <a href="https://www.videolan.org/" target="_blank" rel="noopener noreferrer">VLC media player</a> that accepts an HLS playlist, great! If you&#x27;d rather use an online player, you can navigate to <a href="https://livepush.io/hlsplayer/index.html" target="_blank" rel="noopener noreferrer">Livepush.io</a> for testing purposes.</p>
<p>To get the url of our livestream, we need to get the distribution id of our CloudFront distribution. Navigate to the <a href="https://console.aws.amazon.com/cloudfront/v4/home#/distributions" target="_blank" rel="noopener noreferrer">CloudFront distribution page</a> to find it. Once you have it, the url to our playlist is in the following format:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">https://&lt;cloudfront_id&gt;.CloudFront.net/playlist.m3u8</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can put this url in the player to start watching your stream!</p>
<p><img decoding="async" loading="lazy" alt="HLS player streaming our content" src="/ja/assets/images/hls-player-39988b45026daf5bedb5fcb11dd38170.png" width="970" height="650" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-troubleshooting">6. Troubleshooting<a href="#6-troubleshooting" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h2>
<p>If things go wrong and the stream doesn&#x27;t play, the best way to troubleshoot is to manually check each of the steps that is performed by the HLS video player.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="medialive-and-momento">MediaLive and Momento<a href="#medialive-and-momento" class="hash-link" aria-label="この見 出しへのリンク" title="この見出しへのリンク">​</a></h3>
<p>Verify the master manifest is accessible with <code>player_api_key</code> and returns the variant playlists correctly. Use the following <code>curl</code> command to test, or use the <a href="https://console.gomomento.com/caches/live-origin" target="_blank" rel="noopener noreferrer">Momento console</a> to view data in the namespace.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl &quot;https://&lt;momento_rest_endpoint&gt;/cache/live-origin/playlist.m3u8?token=&lt;player_api_key&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTM3U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-VERSION:3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-INDEPENDENT-SEGMENTS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-STREAM-INF:BANDWIDTH=2648800,AVERAGE-BANDWIDTH=1790800,CODECS=&quot;avc1.77.30,mp4a.40.2&quot;,RESOLUTION=640x480,FRAME-RATE=30.000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">playlist_480p30.m3u8?ttl_seconds=3600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-STREAM-INF:BANDWIDTH=1394800,AVERAGE-BANDWIDTH=965800,CODECS=&quot;avc1.4d400d,mp4a.40.2&quot;,RESOLUTION=320x240,FRAME-RATE=30.000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">playlist_240p30.m3u8?ttl_seconds=3600</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-STREAM-INF:BANDWIDTH=4391200,AVERAGE-BANDWIDTH=2961200,CODECS=&quot;avc1.4d401f,mp4a.40.2&quot;,RESOLUTION=960x720,FRAME-RATE=30.000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">playlist_720p30.m3u8?ttl_seconds=3600</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Verify that each variant playlist is accessible, and if you can download the last media segment listed in the variant playlists (aka <em>the live point</em>). Below are the <code>curl</code> commands to view the 480p manifest and the live point.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl &quot;https://&lt;momento_rest_endpoint&gt;/cache/live-origin/playlist_480p30.m3u8?token=&lt;player_api_key&gt;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTM3U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-VERSION:3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-TARGETDURATION:2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-MEDIA-SEQUENCE:891</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF:2.00000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">playlist_480p30_00891.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF:2.00000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">playlist_480p30_00892.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF:2.00000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF:2.00000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">playlist_480p30_00939.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF:2.00000,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">playlist_480p30_00940.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -o test.ts  &quot;https://&lt;momento_rest_endpoint&gt;/cache/live-origin/playlist_480p30_00940.ts?token=&lt;player_api_key&gt;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When viewing the live point, verify a <code>test.ts</code> file is correctly downloaded and looks OK with your favorite test tool (<a href="https://ffmpeg.org/ffprobe.html" target="_blank" rel="noopener noreferrer">ffprobe</a>, <a href="https://mediaarea.net/en/MediaInfo" target="_blank" rel="noopener noreferrer">mediainfo</a>, etc...).</p>
<p>If any of these steps fails, usual suspects are:</p>
<ul>
<li><code>encoder_api_key</code> or <code>player_api_key</code> might not have the right access level to the namespace.</li>
<li>AWS Elemental MediaLive isn&#x27;t configured correctly or isn&#x27;t running.<!-- -->
<ul>
<li>Double check the URI provided in the <em>Destination URL</em> field at the HLS output group level, and don&#x27;t forget to add the query parameters <code>&amp;ttl_seconds=&lt;ttl&gt;&amp;role=origin</code></li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="cloudfront">CloudFront<a href="#cloudfront" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h3>
<p>If everything looks correct in MediaLive and Momento, verify the requests from CloudFront. The distribution rules already embed an authorization header, so you don&#x27;t need to add <code>player_api_key</code> in the URIs. Verify that CloudFront inserts them properly.</p>
<p>The three commands below produce the same results as the requests sent from the player through CloudFront to Momento Media Storage. Remember that the media segments listed in each variant playlist constantly change, so replace <code>&lt;id&gt;</code> in the final command with a valid value from the fetched playlist:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ curl &quot;https://&lt;cloudfront_id&gt;.CloudFront.net/playlist.m3u8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl &quot;https://&lt;cloudfront_id&gt;.CloudFront.net/playlist_480p30.m3u8&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ curl -o test.ts &quot;https://&lt;cloudfront_id&gt;.CloudFront.net/playlist_480p30_&lt;id&gt;.ts&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If any of these steps fails, usual suspects are:</p>
<ul>
<li>The <em>Authorization</em> header has not been correctly set to the <code>player_api_key</code> when the CloudFront distribution was created.</li>
<li>A CloudFront behavior might be incorrectly set. Double check the file patterns and the associated caching policies.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="thats-it">That&#x27;s it!<a href="#thats-it" class="hash-link" aria-label="この見出しへのリンク" title="この見出しへのリンク">​</a></h2>
<p>Congratulations! You&#x27;ve successfully set up a live video streaming workflow using Momento Media Storage, AWS MediaLive, and Amazon CloudFront. This modern, scalable solution ensures low latency, reliability, and optimal performance for delivering live HLS streams.</p>
<p><strong>Here&#x27;s what you&#x27;ve learned:</strong></p>
<ul>
<li>Configured Momento Media Storage as a highly performant and cost-effective origin server.</li>
<li>Set up AWS MediaLive to encode and push adaptive bitrate streams directly to Momento.</li>
<li>Optimized content delivery using CloudFront to reduce latency, manage costs, and secure playback access.</li>
<li>Tested and troubleshot the setup to ensure seamless streaming from origin to viewers.</li>
</ul>
<p><strong>Next Steps</strong></p>
<p>Now that your live streaming workflow is up and running, consider exploring additional features and optimizations:</p>
<ul>
<li>Learn about <a href="/ja/media-storage/entitlements/about">adding entitlements</a> to your workflow.</li>
<li>Discover <a href="/ja/media-storage/streaming/capture/rtmp">how to use ffmpeg and an RTMP stream</a> to stream to Momento.</li>
<li>Add <a href="/ja/media-storage/enhancements/live-reactions">real-time reactions</a> to your streams.</li>
</ul>
<p>We can&#x27;t wait to see what you build. Happy coding!</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/momentohq/public-dev-docs/tree/main/docs/media-storage/streaming/live-streaming/how-to-medialive-cloudfront.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントのナビゲーション"><a class="pagination-nav__link pagination-nav__link--prev" href="/ja/media-storage/streaming/live-streaming/how-it-works"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">How it works</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#preparation" class="table-of-contents__link toc-highlight">Preparation</a></li><li><a href="#1-create-a-storage-namespace-in-your-momento-account" class="table-of-contents__link toc-highlight">1. Create a storage namespace in your Momento account</a></li><li><a href="#2-set-up-aws-medialive-for-live-video-encoding" class="table-of-contents__link toc-highlight">2. Set up AWS MediaLive for live video encoding</a><ul><li><a href="#channel-settings" class="table-of-contents__link toc-highlight">Channel settings</a></li><li><a href="#input-attachments" class="table-of-contents__link toc-highlight">Input attachments</a></li><li><a href="#output-groups" class="table-of-contents__link toc-highlight">Output groups</a></li></ul></li><li><a href="#3-optimize-content-delivery-with-amazon-cloudfront" class="table-of-contents__link toc-highlight">3. Optimize content delivery with Amazon CloudFront</a></li><li><a href="#4-starting-the-stream" class="table-of-contents__link toc-highlight">4. Starting the stream</a></li><li><a href="#5-watching-the-stream" class="table-of-contents__link toc-highlight">5. Watching the stream</a></li><li><a href="#6-troubleshooting" class="table-of-contents__link toc-highlight">6. Troubleshooting</a><ul><li><a href="#medialive-and-momento" class="table-of-contents__link toc-highlight">MediaLive and Momento</a></li><li><a href="#cloudfront" class="table-of-contents__link toc-highlight">CloudFront</a></li></ul></li><li><a href="#thats-it" class="table-of-contents__link toc-highlight">That&#39;s it!</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Sites</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/ja/">Dev docs</a></li><li class="footer__item"><a href="https://www.gomomento.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Momento</a></li></ul></div><div class="col footer__col"><div class="footer__title">コミュニティ</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/3HkAKjUZGq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/momentohq" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><div class="footer__title">もっと見る</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.gomomento.com/contact-us" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact us</a></li><li class="footer__item"><a href="https://www.gomomento.com/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">公式ブログ</a></li><li class="footer__item"><a href="https://github.com/momentohq" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/ja/img/momento-logo-white.svg" alt="Momento Logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/ja/img/momento-logo-forest.svg" alt="Momento Logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></div><div class="footer__copyright">Copyright © 2022 Momento, Inc.</div></div></div></footer></div>
<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-THBDHDQ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) --></body>
</html>